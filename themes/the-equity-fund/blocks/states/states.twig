{% set limit = 1 %}

{% if states|length %}
<section
  class="theme-cream text-foreground"
  aria-label="{{ headline|default('Grantee states') }}"
  data-block="states"
  x-data="{ expanded: false }"
>
  <h2 class="font-serif">{{ headline }}</h2>

  {% if cta %}
  <a href="{{ cta.url }}">{{ cta.title }}</a>
  {% endif %}

  <ul>
    {% for state in states %}
      {% set grantees = state.grantees %}

      <li class="max-md:data-[hidden]:hidden" :data-hidden="{{ loop.index0 ~ ' >= '|e ~ limit }} && !expanded">
        <a href="{{ state.link }}">
          <h3>{{ state.title }}</h3>

          {% if grantees|length %}
            <p>{{ grantees|length }} grantees</p>
          {% endif %}

          {% if state.handle %}
          <svg aria-hidden="true">
            <use xlink:href="#state-{{ state.handle }}"></use>
          </svg>
          {% endif %}
        </a>
      </li>
    {% endfor %}
  </ul>

  {% if states|length > limit %}
    <button
      class="md:hidden"
      @click="expanded = !expanded"
      x-text="expanded ? 'View less' : 'View all'"
    >
      View all
    </button>
  {% endif %}
</section>
{% endif %}
